<!DOCTYPE html>
<html>

	<head>
		<link rel="shortcut icon" href="https://www.bbraun-brand.com/etc/designs/clientlibs/bbraun/img/favicon.ico">
		<title>ChatBot</title>
		<style>
			html, body { height: 100% }
			body {
				margin: 0;
				background-color: #f2f2f2;
			}
		
			#fenster{
				
				height: 100%;
				width: 100%;
								
			}

			#chatFenster{
			
				display: none;
				background-color: #CCCCCC;
				position: fixed;
				right: 0px;
				bottom: 2px;
				
				height: 70%;
				width: 70%;
				max-height: 1000px;
				max-width: 500px;
				min-height: 300px;
				min-width: 100px;
				
			}
			
			
			
			#webchat {
				height: calc(100% - 39px);
				width: calc(100%-2px);
				padding: 2px;		
			}
			
/* ####################### TOOLBAR ########################*/
			#chatFensterHeader{
				height: 35px;
			}
			/* Hilfe Button */
			#hilfe{
				float: left;
				margin-left: 7px;
				margin-top: 5px;
				margin-bottom: 5px;
				height: 25px;
			}
			#hilfe:hover,
			#hilfe:focus{
				cursor:pointer;
				
			}

			/* Close Button */		
			#close{
		
				float: right;						
				margin-right: 5px;
				height: 35px;	
			}
			#close:hover,
			#close:focus{
				cursor: pointer;
				background-color: #999999;
			}
			
			/* Schriftzug "ComplianceBot" */		
			#textLeiste{
				float: left;
				margin-left: 10px;
				margin-top: 6px;
				font-weight: bold;
				
				
			}
			#textLeiste:hover,
			#textLeiste:focus{
				cursor: default;
			}

			/* MS Teams Button*/
			#msteams{
				float: right;
				margin-right: 7px;	
				height: 35px;
			}
			#msteams:hover,
			#msteams:focus{
				cursor: pointer;
				background-color: #999999;
			}
			
			/* Vollbild Button*/
			#vollbild{
				float: right;
				margin-right: 7px;
				height: 35px;
			}
			#vollbild:hover,
			#vollbild:focus{
				cursor: pointer;
				background-color: #999999;
			}

			/* Kleines Bild Button*/
			#kleinesBild{
				float: right;
				margin-right: 7px;
				display: none;
				height: 35px;
			}
			#kleinesBild:hover,
			#kleinesBild:focus{
				cursor: pointer;
				background-color: #999999;
			}
			
			
			
	/*  ####################### Chatbot Ã¶ffnen ######################## */
			#myBtn{
				height: 70px;
				width: 70px;
				position: fixed;
				right: 5%;
				bottom: 5%;
			}
			#myBtn:hover,
			#myBtn:focus{
				
				cursor: pointer;
			}
			
	/*  ####################### ZEUGS ########################*/	

			/* Changing link color */
			
			a{
				color: #00b482;
			}
		
			/* Maybe broken after update, not necessary */
			.ac-pushButton{
				font-family: RotisSansSerif;
				font-size: 100%;
			}
			.ac-pushButton:hover,
			.ac-pushButton:focus{
				cursor: pointer;
			}
		
			.css-115fwte:hover,
			.css-115fwte:focus{
				cursor: pointer;
			}		
			.ac-textBlock{
				white-space: normal !important;
			}

		</style>

	</head>
	<body style='font-family:RotisSansSerif'>

		<input id="myBtn" type="image" src=".\icons\ButtonChatBotTest.png" />

		<div id=fenster role="main">

	  
			<div id="chatFenster" >
				<div id="chatFensterHeader">
					<input id="hilfe" type="image" src="https://img.icons8.com/ios/100/000000/help.png" />
					<span id="textLeiste">ComplianceBot</span>
					<span id="close" ><img src="https://img.icons8.com/windows/32/000000/minimize-window.png" title="Minimize" height="25px" style="margin: 5px 0px"></span>
					<span id="vollbild"><img src="https://img.icons8.com/android/24/000000/expand.png" title="Maximize" height="19px" style="margin: 8px 3px"></span>
					<span id="kleinesBild"><img src="https://img.icons8.com/android/24/000000/collapse.png" title="Restore Down" height="19px" style="margin: 8px 3px"></span>
					<span id="msteams"><img src="https://img.icons8.com/color/48/000000/microsoft-teams.png" title="Add to Teams" height="25px" style="margin: 5px 0px"></span> 
				</div>
				
				<div id="webchat" role="main"></div>
		</div>
		
		
	  </div>
     
      <!-- 	Inmplement the current webchat version 
			Thats the schema for a Webchat, our own Webchat gets implemented later 


NEW!!!!!!!
			-->
		<script 
			crossorigin="anonymous"
			src="https://cdn.botframework.com/botframework-webchat/4.7.1/webchat-es5.js"
		></script>

		
		<!-- Make chat draggable -->
		<script> 

		dragElement(document.getElementById("chatFenster"));
//		dragElement(document.getElementById("myBtn"));
		
		function dragElement(elmnt){
			var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
			
			if (document.getElementById(elmnt.id + "Header")) {
				// if present, the header is where you move the DIV from:
				document.getElementById(elmnt.id + "Header").onmousedown = dragMouseDown;
				
			}else{
				// otherwise, move the DIV from anywhere inside the DIV:
				elmnt.onmousedown = dragMouseDown;
				
			}
			
		
			function dragMouseDown(e){
				e = e || window.event;
				e.preventDefault();
				
				pos3 = e.clientX;
				pos4 = e.clientY;

				document.onmouseup = closeDragElement;
				document.onmousemove = elementDrag;		
			}
			
			function elementDrag(e){
				e = e || window.event;
				e.preventDefault();
				// left
				pos1 = pos3 - e.clientX;
				// top
				pos2 = pos4 - e.clientY;

				pos3 = e.clientX;
				pos4 = e.clientY;
				
				if(elmnt.offsetTop >= 0){
					elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
				}else{
					elmnt.style.top = "0px";
				}

				if(elmnt.offsetLeft >= -1){
					elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
				}else{
					elmnt.style.left = "0px";
				}
			}
			
			function closeDragElement(){
				document.onmouseup = null;
				document.onmousemove = null;
			}
		}
		</script>

		<script>
		var myBtn = document.getElementById("myBtn");
		var close = document.getElementById("close");
		var vollbild = document.getElementById("vollbild");
		var kleinesBild = document.getElementById("kleinesBild");
		var help = document.getElementById("hilfe");
		var msteams = document.getElementById("msteams");
		
		var styleTop = 0, styleLeft = 0;

		var firstTime = true;

		myBtn.onclick = function(){
			if(firstTime == true){
				if(confirm("By using this bot you agree that personal data might be stored.")){
					chatFenster.style.display = "block";
					myBtn.style.display = "none";
					firstTime = false;	
				}
			}else{
				chatFenster.style.display = "block";
				myBtn.style.display = "none";			
			}
			
			
		}
		close.onclick = function(){
			chatFenster.style.display = "none";			
			myBtn.style.display ="block";
		}
		vollbild.onclick = function(){
			
			styleTop = chatFenster.style.top;
			styleLeft = chatFenster.style.left;
			
			chatFenster.style.maxHeight = '100%';
			chatFenster.style.maxWidth = '100%';
			chatFenster.style.height='100%';
			chatFenster.style.width='100%';
			chatFenster.style.top='0px';
			chatFenster.style.left='0px';
			
			vollbild.style.display = "none";
			kleinesBild.style.display = "block";
		}
		kleinesBild.onclick = function(){
		
			chatFenster.style.maxHeight = '1000px';
			chatFenster.style.maxWidth = '500px';
			chatFenster.style.height='70%';
			chatFenster.style.width='70%';
			chatFenster.style.top = styleTop;
			chatFenster.style.left = styleLeft;
			
			
			kleinesBild.style.display = "none";	
			vollbild.style.display = "block";
					
		}
		help.onclick = function(){
			if(window.confirm("Press OK to send a Email to a Compliance Officer. Press Cancel to cancel.")){
			
				let mailAdress = "niclas.weh_ext@aesculap.de";
				let subject = "ComplianceBot Human Support needed || Priority: HIGH/LOW";
				let body = "Please enter your question and change the priority in the subject to your needs..";
			
				window.location.href = "mailto:" + mailAdress + "?subject=" + subject + "&body=" + body;
				
			}else{
				
			}
		}
		msteams.onclick = function(){
			if(window.confirm("Do you want to open this Chatbot in MicrosoftTeams?")){
				window.location.href = "https://teams.microsoft.com/l/chat/0/0?users=28:10bab881-076b-435a-8bf7-6ef53590c287";
			
			}else{
			
			}
		}
		</script>

		<script>
			webSpeechPonyfillFactory = window.WebChat.createCognitiveServicesSpeechServicesPonyfillFactory({
			//	credentials: {
						region: 'westeurope',
						subscriptionKey: '7fc4b1c310c84ada968e860e7879e316'
			//		}
			})
			window.WebChat.renderWebChat({
				directLine: window.WebChat.createDirectLine({
				//	token: token
					secret: 'A7gfd1ntYMA.eZmaJ3YFb7aUyAQjUdB5LyMfN3yh1h_RfkBIE9ozf9g',
					
				}),
				webSpeechPonyfillFactory: webSpeechPonyfillFactory,
				// disable timestamp
				groupTimestamp: false,
					
				//set language
				locale: 'en-US',
					
				// Passing 'styleOptions' when rendering Web Chat 
				// Must be here because of IE11
				styleOptions: {
			 
				 // chatbot
					bubbleBackground: '#711E82',
					bubbleTextColor: 'white',
					bubbleBorderColor: '#711E82',
					bubbleBorderRadius: 15,
					bubbleBorderStyle: 'solid',
					bubbleBorderWidth: 1,
					bubbleMaxWidth: 1000,

					 // User  
					bubbleFromUserBackground: '#00B482',
					bubbleFromUserTextColor: 'white',
					bubbleFromUserBorderColor: '#00B482',
					bubbleFromUserBorderRadius: 15,
					bubbleFromUserBorderStyle: 'solid',
					bubbleFromUserBorderWidth: 1,

					accent: 'black',

					backgroundColor: 'white',
					primaryFont: 'RotisSansSerif',
					
					hideUploadButton: true,
						
					// Avatar ausblenden            
					avatarSize: 0   
				}
			}, 
				document.getElementById('webchat'));
			
         
      </script>
	</body>
</html>
